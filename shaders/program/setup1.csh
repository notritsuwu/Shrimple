#include "/lib/constants.glsl"
#include "/lib/common.glsl"

layout (local_size_x = 8, local_size_y = 8, local_size_z = 1) in;

const ivec3 workGroups = ivec3(32, 32, 1);

layout(rgba8) uniform writeonly image2D imgBlockLight;

#include "/lib/blocks.glsl"


const vec3 color_White = vec3(255);
const vec3 color_Amethyst = vec3(118, 58, 201);
const vec3 color_Candle = vec3(230, 144, 76);
const vec3 color_CopperBulb = vec3(230, 204, 128);
const vec3 color_Fire = vec3(220, 152, 89);
const vec3 color_Furnace = vec3(196, 159, 114);
const vec3 color_RedstoneTorch = vec3(232, 59, 21);
const vec3 color_RespawnAnchor = vec3(99, 17, 165);
const vec3 color_SeaPickle = vec3(72, 100, 54);
const vec3 color_SoulFire = vec3(25, 184, 229);

const vec3 color_CandleBlack = vec3(51, 51, 51);
const vec3 color_CandleBlue = vec3(0, 66, 255);
const vec3 color_CandleBrown = vec3(117, 67, 38);
const vec3 color_CandleCyan = vec3(0, 214, 214);
const vec3 color_CandleGray = vec3(84, 91, 99);
const vec3 color_CandleGreen = vec3(67, 115, 0);
const vec3 color_CandleLightBlue = vec3(39, 175, 255);
const vec3 color_CandleLightGray = vec3(161, 160, 159);
const vec3 color_CandleLime = vec3(112, 227, 0);
const vec3 color_CandleMagenta = vec3(193, 25, 207);
const vec3 color_CandleOrange = vec3(255, 117, 0);
const vec3 color_CandlePink = vec3(255, 141, 183);
const vec3 color_CandlePurple = vec3(145, 0, 255);
const vec3 color_CandleRed = vec3(219, 0, 0);
const vec3 color_CandleYellow = vec3(255, 224, 0);


void main() {
    uint blockId = gl_GlobalInvocationID.x + gl_GlobalInvocationID.y * 256u;
    vec3 color = vec3(0.0);
    float range = 0.0;

    switch (blockId) {
        case BLOCK_LIGHT_1:
            color = color_White;
            range = 1;
            break;
        case BLOCK_LIGHT_2:
            color = color_White;
            range = 2;
            break;
        case BLOCK_LIGHT_3:
            color = color_White;
            range = 3;
            break;
        case BLOCK_LIGHT_4:
            color = color_White;
            range = 4;
            break;
        case BLOCK_LIGHT_5:
            color = color_White;
            range = 5;
            break;
        case BLOCK_LIGHT_6:
            color = color_White;
            range = 6;
            break;
        case BLOCK_LIGHT_7:
            color = color_White;
            range = 7;
            break;
        case BLOCK_LIGHT_8:
            color = color_White;
            range = 8;
            break;
        case BLOCK_LIGHT_9:
            color = color_White;
            range = 9;
            break;
        case BLOCK_LIGHT_10:
            color = color_White;
            range = 10;
            break;
        case BLOCK_LIGHT_11:
            color = color_White;
            range = 11;
            break;
        case BLOCK_LIGHT_12:
            color = color_White;
            range = 12;
            break;
        case BLOCK_LIGHT_13:
            color = color_White;
            range = 13;
            break;
        case BLOCK_LIGHT_14:
            color = color_White;
            range = 14;
            break;
        case BLOCK_LIGHT_15:
            color = color_White;
            range = 15;
            break;
        case BLOCK_AMETHYST_BUD_LARGE:
            color = color_Amethyst;
            range = 4;
            break;
        case BLOCK_AMETHYST_BUD_MEDIUM:
            color = color_Amethyst;
            range = 2;
            break;
        case BLOCK_AMETHYST_CLUSTER:
            color = color_Amethyst;
            range = 5;
            break;
        case BLOCK_BEACON:
            color = color_White;
            range = 15;
            break;
        case BLOCK_BLAST_FURNACE_LIT_N:
        case BLOCK_BLAST_FURNACE_LIT_E:
        case BLOCK_BLAST_FURNACE_LIT_S:
        case BLOCK_BLAST_FURNACE_LIT_W:
            color = color_Furnace;
            range = 6;
            break;
        case BLOCK_BREWING_STAND:
            color = color_Furnace;
            range = 2;
            break;
        case BLOCK_CANDLE_CAKE:
            color = color_Candle;
            range = 3;
            break;
        case BLOCK_CAVEVINE_BERRIES:
            color = vec3(230, 120, 30);
            range = 14;
            break;
        case BLOCK_COPPER_BULB_LIT:
            color = color_CopperBulb;
            range = 15;
            break;
        case BLOCK_COPPER_BULB_EXPOSED_LIT:
            color = color_CopperBulb;
            range = 12;
            break;
        case BLOCK_COPPER_BULB_OXIDIZED_LIT:
            color = color_CopperBulb;
            range = 4;
            break;
        case BLOCK_COPPER_BULB_WEATHERED_LIT:
            color = color_CopperBulb;
            range = 8;
            break;
        case BLOCK_COPPER_TORCH_FLOOR:
        case BLOCK_COPPER_TORCH_WALL_N:
        case BLOCK_COPPER_TORCH_WALL_E:
        case BLOCK_COPPER_TORCH_WALL_S:
        case BLOCK_COPPER_TORCH_WALL_W:
            color = vec3(126, 230, 25);
            range = 14;
            break;
        case BLOCK_CREAKING_HEART:
            color = vec3(230, 128, 47);
            range = 8;
            break;
        case BLOCK_EYEBLOSSOM_OPEN:
            color = vec3(230, 128, 47);
            range = 2;
            break;
        case BLOCK_CRYING_OBSIDIAN:
            color = vec3(99, 17, 165);
            range = 10;
            break;
        case BLOCK_END_ROD:
            color = vec3(244, 237, 223);
            range = 14;
            break;
        case BLOCK_CAMPFIRE_N_S:
        case BLOCK_CAMPFIRE_W_E:
        case BLOCK_FIRE:
            color = color_Fire;
            range = 15;
            break;
        case BLOCK_FROGLIGHT_OCHRE:
            color = vec3(196, 165, 28);
            range = 15;
            break;
        case BLOCK_FROGLIGHT_PEARLESCENT:
            color = vec3(188, 111, 168);
            range = 15;
            break;
        case BLOCK_FROGLIGHT_VERDANT:
            color = vec3(118, 195, 104);
            range = 15;
            break;
        case BLOCK_FURNACE_LIT_N:
        case BLOCK_FURNACE_LIT_E:
        case BLOCK_FURNACE_LIT_S:
        case BLOCK_FURNACE_LIT_W:
            color = color_Furnace;
            range = 6;
            break;
        case BLOCK_GLOWSTONE:
            color = vec3(190, 151, 83);
            range = 15;
            break;
//        case BLOCK_GLOWSTONE_DUST:
//            color = vec4(190, 151, 83, 6);
//            break;
        case BLOCK_GLOW_LICHEN:
            color = vec3(87, 184, 110);
            range = 7;
            break;
        case BLOCK_JACK_O_LANTERN_N:
        case BLOCK_JACK_O_LANTERN_E:
        case BLOCK_JACK_O_LANTERN_S:
        case BLOCK_JACK_O_LANTERN_W:
            color = vec3(196, 179, 83);
            range = 15;
            break;
        case BLOCK_LANTERN_CEIL:
        case BLOCK_LANTERN_FLOOR:
            color = vec3(231, 188, 115);
            range = 12;
            break;
        case BLOCK_LAVA:
            color = vec3(245, 117, 66);
            range = 15;
            break;
        case BLOCK_LIGHTING_ROD_POWERED:
            color = vec3(222, 244, 249);
            range = 8;
            break;
        case BLOCK_MAGMA:
            color = vec3(190, 82, 28);
            range = 3;
            break;
        case BLOCK_NETHER_PORTAL:
            color = vec3(128, 42, 212);
            range = 11;
            break;
        case BLOCK_REDSTONE_LAMP_LIT:
            color = vec3(243, 203, 126);
            range = 15;
            break;
        case BLOCK_REDSTONE_ORE_LIT:
            color = color_RedstoneTorch;
            range = 9;
            break;
        case BLOCK_REDSTONE_TORCH_FLOOR_LIT:
        case BLOCK_REDSTONE_TORCH_WALL_N_LIT:
        case BLOCK_REDSTONE_TORCH_WALL_E_LIT:
        case BLOCK_REDSTONE_TORCH_WALL_S_LIT:
        case BLOCK_REDSTONE_TORCH_WALL_W_LIT:
            color = color_RedstoneTorch;
            range = 7;
            break;
        case BLOCK_REDSTONE_WIRE_1:
            color = color_RedstoneTorch;
            range = 1.0;
            break;
        case BLOCK_REDSTONE_WIRE_2:
            color = color_RedstoneTorch;
            range = 1.5;
            break;
        case BLOCK_REDSTONE_WIRE_3:
            color = color_RedstoneTorch;
            range = 2.0;
            break;
        case BLOCK_REDSTONE_WIRE_4:
            color = color_RedstoneTorch;
            range = 2.5;
            break;
        case BLOCK_REDSTONE_WIRE_5:
            color = color_RedstoneTorch;
            range = 3.0;
            break;
        case BLOCK_REDSTONE_WIRE_6:
            color = color_RedstoneTorch;
            range = 3.5;
            break;
        case BLOCK_REDSTONE_WIRE_7:
            color = color_RedstoneTorch;
            range = 4.0;
            break;
        case BLOCK_REDSTONE_WIRE_8:
            color = color_RedstoneTorch;
            range = 4.5;
            break;
        case BLOCK_REDSTONE_WIRE_9:
            color = color_RedstoneTorch;
            range = 5.0;
            break;
        case BLOCK_REDSTONE_WIRE_10:
            color = color_RedstoneTorch;
            range = 5.5;
            break;
        case BLOCK_REDSTONE_WIRE_11:
            color = color_RedstoneTorch;
            range = 6.0;
            break;
        case BLOCK_REDSTONE_WIRE_12:
            color = color_RedstoneTorch;
            range = 6.5;
            break;
        case BLOCK_REDSTONE_WIRE_13:
            color = color_RedstoneTorch;
            range = 7.0;
            break;
        case BLOCK_REDSTONE_WIRE_14:
            color = color_RedstoneTorch;
            range = 7.5;
            break;
        case BLOCK_REDSTONE_WIRE_15:
            color = color_RedstoneTorch;
            range = 8.0;
            break;
        case BLOCK_REPEATER:
            color = color_RedstoneTorch;
            range = 7;
            break;
        case BLOCK_RESPAWN_ANCHOR_1:
            color = color_RespawnAnchor;
            range = 3;
            break;
        case BLOCK_RESPAWN_ANCHOR_2:
            color = color_RespawnAnchor;
            range = 7;
            break;
        case BLOCK_RESPAWN_ANCHOR_3:
            color = color_RespawnAnchor;
            range = 11;
            break;
        case BLOCK_RESPAWN_ANCHOR_4:
            color = color_RespawnAnchor;
            range = 15;
            break;
        case BLOCK_SCULK_CATALYST:
            color = vec3(46, 91, 94);
            range = 6;
            break;
        case BLOCK_SEA_LANTERN:
            color = vec3(141, 191, 219);
            range = 15;
            break;
        case BLOCK_SEA_PICKLE_WET_1:
            color = color_SeaPickle;
            range = 6;
            break;
        case BLOCK_SEA_PICKLE_WET_2:
            color = color_SeaPickle;
            range = 9;
            break;
        case BLOCK_SEA_PICKLE_WET_3:
            color = color_SeaPickle;
            range = 12;
            break;
        case BLOCK_SEA_PICKLE_WET_4:
            color = color_SeaPickle;
            range = 15;
            break;
        case BLOCK_SHROOMLIGHT:
            color = vec3(216, 120, 52);
            range = 15;
            break;
        case BLOCK_SMOKER_LIT_N:
        case BLOCK_SMOKER_LIT_E:
        case BLOCK_SMOKER_LIT_S:
        case BLOCK_SMOKER_LIT_W:
            color = color_Furnace;
            range = 6;
            break;
        case BLOCK_SOUL_CAMPFIRE_LIT_N_S:
        case BLOCK_SOUL_CAMPFIRE_LIT_W_E:
        case BLOCK_SOUL_FIRE:
        case BLOCK_SOUL_LANTERN_CEIL:
        case BLOCK_SOUL_LANTERN_FLOOR:
            color = color_SoulFire;
            range = 12;
            break;
        case BLOCK_SOUL_TORCH_FLOOR:
        case BLOCK_SOUL_TORCH_WALL_N:
        case BLOCK_SOUL_TORCH_WALL_E:
        case BLOCK_SOUL_TORCH_WALL_S:
        case BLOCK_SOUL_TORCH_WALL_W:
            color = color_SoulFire;
            range = 10;
            break;
        case BLOCK_TORCH_FLOOR:
        case BLOCK_TORCH_WALL_N:
        case BLOCK_TORCH_WALL_E:
        case BLOCK_TORCH_WALL_S:
        case BLOCK_TORCH_WALL_W:
            color = vec3(245, 117, 66);
            range = 12;
            break;
    }

    switch (blockId) {
        case BLOCK_HONEY:
            color = vec3(251, 187, 64);
            break;
        case BLOCK_LEAVES:
        case BLOCK_LEAVES_CHERRY:
            color = vec3(128, 128, 128);
            break;
        case BLOCK_ROOTS:
            color = vec3(166, 179, 166);
            break;
        case BLOCK_SLIME:
            color = vec3(104, 185, 84);
            break;
        case BLOCK_SNOW:
            color = vec3(96, 139, 158);
            break;
        case BLOCK_STAINED_GLASS_BLACK:
            color = vec3(77, 77, 77);
            break;
        case BLOCK_STAINED_GLASS_BLUE:
            color = vec3(26, 26, 250);
            break;
        case BLOCK_STAINED_GLASS_BROWN:
            color = vec3(144, 99, 38);
            break;
        case BLOCK_STAINED_GLASS_CYAN:
            color = vec3(21, 136, 195);
            break;
        case BLOCK_STAINED_GLASS_GRAY:
            color = vec3(102, 102, 102);
            break;
        case BLOCK_STAINED_GLASS_GREEN:
            color = vec3(32, 206, 21);
            break;
        case BLOCK_STAINED_GLASS_LIGHT_BLUE:
            color = vec3(82, 175, 244);
            break;
        case BLOCK_STAINED_GLASS_LIGHT_GRAY:
            color = vec3(179, 179, 179);
            break;
        case BLOCK_STAINED_GLASS_LIME:
            color = vec3(161, 236, 32);
            break;
        case BLOCK_STAINED_GLASS_MAGENTA:
            color = vec3(178, 76, 216);
            break;
        case BLOCK_STAINED_GLASS_ORANGE:
            color = vec3(234, 149, 47);
            break;
        case BLOCK_STAINED_GLASS_PINK:
            color = vec3(242, 70, 127);
            break;
        case BLOCK_STAINED_GLASS_PURPLE:
            color = vec3(147, 43, 231);
            break;
        case BLOCK_STAINED_GLASS_RED:
            color = vec3(255, 48, 48);
            break;
        case BLOCK_STAINED_GLASS_WHITE:
            color = vec3(245, 245, 245);
            break;
        case BLOCK_STAINED_GLASS_YELLOW:
            color = vec3(246, 246, 31);
            break;
        case BLOCK_TINTED_GLASS:
            color = vec3(51, 26, 51);
            break;

//        case BLOCK_CANDLE_CAKE_LIT:
//            lightType = LIGHT_CANDLE_CAKE;
//            break;
//        case BLOCK_CANDLE_HOLDER_LIT_1:
//        lightType = LIGHT_CANDLES_1;
//        break;
//        case BLOCK_CANDLE_HOLDER_LIT_2:
//        lightType = LIGHT_CANDLES_2;
//        break;
//        case BLOCK_CANDLE_HOLDER_LIT_3:
//        lightType = LIGHT_CANDLES_3;
//        break;
//        case BLOCK_CANDLE_HOLDER_LIT_4:
//        lightType = LIGHT_CANDLES_4;
//        break;
//        case BLOCK_CAULDRON_LAVA:
//            lightType = LIGHT_LAVA_CAULDRON;
//            break;
    }

    #ifdef LIGHTING_COLORED_CANDLES
        switch (blockId) {
            case BLOCK_BLACK_CANDLES_LIT_1:
                color = color_CandleBlack;
                range = 3;
                break;
            case BLOCK_BLACK_CANDLES_LIT_2:
                color = color_CandleBlack;
                range = 6;
                break;
            case BLOCK_BLACK_CANDLES_LIT_3:
                color = color_CandleBlack;
                range = 9;
                break;
            case BLOCK_BLACK_CANDLES_LIT_4:
                color = color_CandleBlack;
                range = 12;
                break;
            case BLOCK_BLUE_CANDLES_LIT_1:
                color = color_CandleBlue;
                range = 3;
                break;
            case BLOCK_BLUE_CANDLES_LIT_2:
                color = color_CandleBlue;
                range = 6;
                break;
            case BLOCK_BLUE_CANDLES_LIT_3:
                color = color_CandleBlue;
                range = 9;
                break;
            case BLOCK_BLUE_CANDLES_LIT_4:
                color = color_CandleBlue;
                range = 12;
                break;
            case BLOCK_BROWN_CANDLES_LIT_1:
                color = color_CandleBrown;
                range = 3;
                break;
            case BLOCK_BROWN_CANDLES_LIT_2:
                color = color_CandleBrown;
                range = 6;
                break;
            case BLOCK_BROWN_CANDLES_LIT_3:
                color = color_CandleBrown;
                range = 9;
                break;
            case BLOCK_BROWN_CANDLES_LIT_4:
                color = color_CandleBrown;
                range = 12;
                break;
            case BLOCK_CYAN_CANDLES_LIT_1:
                color = color_CandleCyan;
                range = 3;
                break;
            case BLOCK_CYAN_CANDLES_LIT_2:
                color = color_CandleCyan;
                range = 6;
                break;
            case BLOCK_CYAN_CANDLES_LIT_3:
                color = color_CandleCyan;
                range = 9;
                break;
            case BLOCK_CYAN_CANDLES_LIT_4:
                color = color_CandleCyan;
                range = 12;
                break;
            case BLOCK_GRAY_CANDLES_LIT_1:
                color = color_CandleGray;
                range = 3;
                break;
            case BLOCK_GRAY_CANDLES_LIT_2:
                color = color_CandleGray;
                range = 6;
                break;
            case BLOCK_GRAY_CANDLES_LIT_3:
                color = color_CandleGray;
                range = 9;
                break;
            case BLOCK_GRAY_CANDLES_LIT_4:
                color = color_CandleGray;
                range = 12;
                break;
            case BLOCK_GREEN_CANDLES_LIT_1:
                color = color_CandleGreen;
                range = 3;
                break;
            case BLOCK_GREEN_CANDLES_LIT_2:
                color = color_CandleGreen;
                range = 6;
                break;
            case BLOCK_GREEN_CANDLES_LIT_3:
                color = color_CandleGreen;
                range = 9;
                break;
            case BLOCK_GREEN_CANDLES_LIT_4:
                color = color_CandleGreen;
                range = 12;
                break;
            case BLOCK_LIGHT_BLUE_CANDLES_LIT_1:
                color = color_CandleLightBlue;
                range = 3;
                break;
            case BLOCK_LIGHT_BLUE_CANDLES_LIT_2:
                color = color_CandleLightBlue;
                range = 6;
                break;
            case BLOCK_LIGHT_BLUE_CANDLES_LIT_3:
                color = color_CandleLightBlue;
                range = 9;
                break;
            case BLOCK_LIGHT_BLUE_CANDLES_LIT_4:
                color = color_CandleLightBlue;
                range = 12;
                break;
            case BLOCK_LIGHT_GRAY_CANDLES_LIT_1:
                color = color_CandleLightGray;
                range = 3;
                break;
            case BLOCK_LIGHT_GRAY_CANDLES_LIT_2:
                color = color_CandleLightGray;
                range = 6;
                break;
            case BLOCK_LIGHT_GRAY_CANDLES_LIT_3:
                color = color_CandleLightGray;
                range = 9;
                break;
            case BLOCK_LIGHT_GRAY_CANDLES_LIT_4:
                color = color_CandleLightGray;
                range = 12;
                break;
            case BLOCK_LIME_CANDLES_LIT_1:
                color = color_CandleLime;
                range = 3;
                break;
            case BLOCK_LIME_CANDLES_LIT_2:
                color = color_CandleLime;
                range = 6;
                break;
            case BLOCK_LIME_CANDLES_LIT_3:
                color = color_CandleLime;
                range = 9;
                break;
            case BLOCK_LIME_CANDLES_LIT_4:
                color = color_CandleLime;
                range = 12;
                break;
            case BLOCK_MAGENTA_CANDLES_LIT_1:
                color = color_CandleMagenta;
                range = 3;
                break;
            case BLOCK_MAGENTA_CANDLES_LIT_2:
                color = color_CandleMagenta;
                range = 6;
                break;
            case BLOCK_MAGENTA_CANDLES_LIT_3:
                color = color_CandleMagenta;
                range = 9;
                break;
            case BLOCK_MAGENTA_CANDLES_LIT_4:
                color = color_CandleMagenta;
                range = 12;
                break;
            case BLOCK_ORANGE_CANDLES_LIT_1:
                color = color_CandleOrange;
                range = 3;
                break;
            case BLOCK_ORANGE_CANDLES_LIT_2:
                color = color_CandleOrange;
                range = 6;
                break;
            case BLOCK_ORANGE_CANDLES_LIT_3:
                color = color_CandleOrange;
                range = 9;
                break;
            case BLOCK_ORANGE_CANDLES_LIT_4:
                color = color_CandleOrange;
                range = 12;
                break;
            case BLOCK_PINK_CANDLES_LIT_1:
                color = color_CandlePink;
                range = 3;
                break;
            case BLOCK_PINK_CANDLES_LIT_2:
                color = color_CandlePink;
                range = 6;
                break;
            case BLOCK_PINK_CANDLES_LIT_3:
                color = color_CandlePink;
                range = 9;
                break;
            case BLOCK_PINK_CANDLES_LIT_4:
                color = color_CandlePink;
                range = 12;
                break;
            case BLOCK_PURPLE_CANDLES_LIT_1:
                color = color_CandlePurple;
                range = 3;
                break;
            case BLOCK_PURPLE_CANDLES_LIT_2:
                color = color_CandlePurple;
                range = 6;
                break;
            case BLOCK_PURPLE_CANDLES_LIT_3:
                color = color_CandlePurple;
                range = 9;
                break;
            case BLOCK_PURPLE_CANDLES_LIT_4:
                color = color_CandlePurple;
                range = 12;
                break;
            case BLOCK_RED_CANDLES_LIT_1:
                color = color_CandleRed;
                range = 3;
                break;
            case BLOCK_RED_CANDLES_LIT_2:
                color = color_CandleRed;
                range = 6;
                break;
            case BLOCK_RED_CANDLES_LIT_3:
                color = color_CandleRed;
                range = 9;
                break;
            case BLOCK_RED_CANDLES_LIT_4:
                color = color_CandleRed;
                range = 12;
                break;
            case BLOCK_WHITE_CANDLES_LIT_1:
                color = color_White;
                range = 3;
                break;
            case BLOCK_WHITE_CANDLES_LIT_2:
                color = color_White;
                range = 6;
                break;
            case BLOCK_WHITE_CANDLES_LIT_3:
                color = color_White;
                range = 9;
                break;
            case BLOCK_WHITE_CANDLES_LIT_4:
                color = color_White;
                range = 12;
                break;
            case BLOCK_YELLOW_CANDLES_LIT_1:
                color = color_CandleYellow;
                range = 3;
                break;
            case BLOCK_YELLOW_CANDLES_LIT_2:
                color = color_CandleYellow;
                range = 6;
                break;
            case BLOCK_YELLOW_CANDLES_LIT_3:
                color = color_CandleYellow;
                range = 9;
                break;
            case BLOCK_YELLOW_CANDLES_LIT_4:
                color = color_CandleYellow;
                range = 12;
                break;
        }
    #else
        switch (lightType) {
            case BLOCK_CANDLES_LIT_1:
                color = color_Candle;
                range = 3;
                break;
            case BLOCK_CANDLES_LIT_2:
                color = color_Candle;
                range = 6;
                break;
            case BLOCK_CANDLES_LIT_3:
                color = color_Candle;
                range = 9;
                break;
            case BLOCK_CANDLES_LIT_4:
                color = color_Candle;
                range = 12;
                break;
        }
    #endif

    // TODO: pre-add 0.5?
    vec4 data = vec4(color / 255.0, range / 32.0);
    imageStore(imgBlockLight, ivec2(gl_GlobalInvocationID.xy), data);
}
